import{A as Ce,x as we,B as X,z as Te}from"./index-BCrRIqGG.js";import{r as j,n as e,O as ue,q as ve}from"./chunk-K6AXKMTT-YwewBSBh.js";import{u as ce,c as ke,a as Ae,B as m,H as le,F as Q,T as Fe,b as Oe,D as E,V as Y,d as C,e as ge,f as he,g as pe,C as me,L as xe,h as Me,t as ye,i as Re,j as K,k as je,l as fe,m as ze,n as Ee,M as Le,o as Ne,p as de,q as We}from"./getData-j5-LWEbE.js";import"./index-C-j6SY-t.js";function D(t={}){const{onClose:n,onOpen:r,open:l}=t,s=ce(r),g=ce(n),[d,i]=j.useState(t.defaultOpen||!1),x=l!==void 0?l:d,w=l!==void 0,F=j.useCallback(()=>{w||i(!1),g==null||g()},[w,g]),O=j.useCallback(()=>{w||i(!0),s==null||s()},[w,s]),U=j.useCallback(()=>{x?F():O()},[x,O,F]);return{open:x,onOpen:O,onClose:F,onToggle:U}}const[Xe,Ie]=ke({name:"FieldContext",hookName:"useFieldContext",providerName:"<FieldProvider />",strict:!1}),be=j.forwardRef((t,n)=>{const r=Ie(),l=Ce(r==null?void 0:r.getInputProps(),t);return e.jsx(Ae.input,{...l,ref:n})});be.displayName="FieldInput";const{withContext:Ue,PropsProvider:Je}=we({key:"input"}),De=Ue(be),Qe={features:"purple",formats:"blue",languages:"green",communities:"orange",type:"cyan"};function L({displayName:t,options:n,selected:r,onToggle:l}){const s=Object.keys(n),g=Qe[t.toLowerCase().split(" ")[0]]||"blue";return e.jsxs(m,{children:[e.jsx(le,{size:"sm",mb:2,color:"inherit",children:t}),e.jsx(Q,{gap:2,flexWrap:"wrap",children:s.map(d=>{const i=r.includes(d);return e.jsx(m,{children:e.jsx(Fe,{content:n[d],children:e.jsx(X,{size:"xs",variant:"outline",colorScheme:i?g:"gray",onClick:()=>{l(d)},fontWeight:"normal",px:3,height:"24px",borderRadius:"full",borderWidth:"1px",color:"inherit",bg:i?`${g}.100`:"transparent",borderColor:i?`${g}.200`:"gray.200",_dark:{borderColor:i?`${g}.800`:"gray.400",bg:i?`${g}.900`:"transparent",_hover:{bg:i?`${g}.800`:"whiteAlpha.100",borderColor:i?`${g}.300`:"whiteAlpha.500"}},_hover:{bg:i?`${g}.200`:"gray.50",borderColor:i?`${g}.300`:"gray.300"},children:n[d]})})},d)})})]})}const Se=({value:t,onChange:n,placeholder:r="Search meetings...",isInvalid:l=!1})=>e.jsxs(m,{position:"relative",children:[e.jsx(m,{position:"absolute",left:3,top:"50%",transform:"translateY(-50%)",color:"gray.400",zIndex:2,children:e.jsx(Oe,{})}),e.jsx(De,{value:t,onChange:s=>{n(s.target.value)},placeholder:r,pl:10,variant:"outline",bg:l?"red.100":"white",_dark:{bg:l?"red.300":"whiteAlpha.100",borderColor:l?"red.500":"whiteAlpha.300",color:"white",_hover:{bg:l?"red.400":"whiteAlpha.200"},_focus:{bg:l?"red.400":"whiteAlpha.300",borderColor:l?"red.500":"blue.300"}}})]});function _e({filterParams:t,sendFilterSelectionsToParent:n}){const[r,l]=j.useState(t.get("nameQuery")??""),[s,g]=j.useState(!1);j.useEffect(()=>{const o=setTimeout(()=>{y(r)},300);g(r.length>0&&r.length<3);const y=a=>{n(f=>{const p=new URLSearchParams(f);return a.length>2?p.set("nameQuery",a):a.length==0&&p.delete("nameQuery"),p})};return()=>{clearTimeout(o)}},[r,n]);const d={morning:{start:"04:00",end:"10:59",hours:7},midday:{start:"11:00",end:"12:59",hours:2},afternoon:{start:"13:00",end:"16:59",hours:4},evening:{start:"17:00",end:"20:59",hours:4},night:{start:"21:00",end:"03:59",hours:7}},i=E.local().hour,x=i>=4&&i<11?"morning":i>=11&&i<13?"midday":i>=13&&i<17?"afternoon":i>=17&&i<21?"evening":"night",w=E.local().toFormat("cccc").toLowerCase(),[F,O]=j.useState(w),[U,_]=j.useState(x),B=t.getAll("features").length>0||t.getAll("formats").length>0||t.getAll("type").length>0||t.getAll("communities").length>0||t.getAll("languages").length>0,H=r||B||F!==w||U!==x,N=()=>{l(""),O(w),_(x),n({})},W=o=>y=>{n(a=>{const f=ye(t.getAll(o),y);return a.delete(o),f.forEach(p=>{a.append(o,p)}),a})},ee=o=>y=>{n(a=>{const p=t.getAll(o).includes(y);return a.delete(o),p||a.append(o,y),a})},te=o=>{W("formats")(o)},ne=o=>{W("features")(o)},se=o=>{ee("type")(o)},$=o=>{W("communities")(o)},T=()=>{const o=document.getElementById("timeFrame"),y=document.getElementById("day"),a=o.value,f=y.value;_(a),O(f);const P={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:7}[f.toLowerCase()],z=E.local();let I=0,V=0;if(a in d){const{start:k}=d[a];I=parseInt(k.split(":")[0],10),V=parseInt(k.split(":")[1],10)}else{const[k,A]=a.split(":").map(Number);I=k,V=A}let v=z.set({weekday:P,hour:I,minute:V,second:0,millisecond:0});if(z.weekday===P&&(z.hour>I||z.hour===I&&z.minute>=V)?v=v.plus({weeks:1}):z.weekday>P&&(v=v.plus({weeks:1})),a in d){const{hours:k}=d[a],A=v.toUTC().toISO();n(u=>(A&&u.set("start",A),u.set("hours",k.toString()),u))}else{const k=v.toUTC().toISO();n(A=>(k&&A.set("start",k),A.set("hours","1"),A))}},M=o=>{W("languages")(o)},R=o=>{l(o)};return e.jsx(e.Fragment,{children:e.jsx(m,{p:4,borderRadius:"lg",_dark:{borderColor:"whiteAlpha.200"},children:e.jsxs(Y,{gap:4,align:"stretch",children:[e.jsx(le,{size:"md",color:"inherit",children:"Filters"}),e.jsxs(m,{children:[e.jsx(C,{fontWeight:"bold",mb:2,children:"Day:"}),e.jsxs("select",{id:"day",name:"day",value:F,onChange:T,children:[e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"}),e.jsx("option",{value:"saturday",children:"Saturday"}),e.jsx("option",{value:"sunday",children:"Sunday"})]})]}),e.jsxs(m,{children:[e.jsx(C,{fontWeight:"bold",mb:2,children:"Time Frame:"}),e.jsxs("select",{id:"timeFrame",name:"timeFrame",value:U,onChange:T,children:[e.jsx("option",{value:"morning",children:"Morning"}),e.jsx("option",{value:"midday",children:"Midday"}),e.jsx("option",{value:"afternoon",children:"Afternoon"}),e.jsx("option",{value:"evening",children:"Evening"}),e.jsx("option",{value:"night",children:"Night"}),e.jsx("option",{disabled:!0,children:"──────────"}),Array.from({length:24}).map((o,y)=>{const a=E.fromObject({hour:y,minute:0}),f=a.toLocaleString(E.TIME_SIMPLE),p=a.toFormat("HH:mm");return e.jsx("option",{value:p,children:f},p)})]})]}),e.jsx(Se,{value:r,onChange:R,isInvalid:s}),s&&e.jsx(C,{fontSize:"sm",color:"red.500",mt:0,children:"Enter at least 3 characters."}),e.jsx(L,{displayName:"Meeting Type",options:ge,selected:t.getAll("type"),onToggle:se}),e.jsx(L,{displayName:"Formats",options:he,selected:t.getAll("formats"),onToggle:te}),e.jsx(L,{displayName:"Features",options:pe,selected:t.getAll("features"),onToggle:ne}),e.jsx(L,{displayName:"Communities",options:me,selected:t.getAll("communities"),onToggle:$}),e.jsx(L,{displayName:"Languages",options:xe,selected:t.getAll("languages"),onToggle:M}),H&&e.jsx(X,{size:"sm",variant:"ghost",colorScheme:"gray",onClick:N,color:"gray.600",_dark:{color:"gray.200",_hover:{bg:"whiteAlpha.200"}},children:e.jsxs(Q,{align:"center",gap:2,children:[e.jsx(Me,{}),e.jsx(C,{children:"Clear Filters"})]})})]})})})}const ae=({label:t,isActive:n,onClick:r})=>e.jsx(X,{size:"sm",variant:n?"solid":"outline",colorScheme:n?"blue":"gray",onClick:r,borderRadius:"full",px:4,h:8,fontSize:"sm",fontWeight:"medium",flexShrink:0,children:t}),G=({title:t,isOpen:n,onToggle:r,children:l,badge:s})=>e.jsxs(m,{borderWidth:"1px",borderColor:"gray.200",_dark:{borderColor:"gray.700"},borderRadius:"md",children:[e.jsxs(X,{w:"full",h:"auto",p:3,variant:"ghost",onClick:r,justifyContent:"space-between",fontWeight:"medium",fontSize:"sm",borderRadius:"md",_hover:{bg:"gray.50",_dark:{bg:"gray.700"}},children:[e.jsxs(Q,{align:"center",gap:2,children:[e.jsx(C,{children:t}),s&&s>0&&e.jsx(K,{colorScheme:"blue",variant:"solid",borderRadius:"full",px:2,py:.5,fontSize:"xs",children:s})]}),n?e.jsx(je,{}):e.jsx(fe,{})]}),n&&e.jsx(m,{p:3,pt:0,children:l})]}),Be=({filterParams:t,sendFilterSelectionsToParent:n,totalMeetings:r,shownMeetings:l})=>{const[s,g]=j.useState(t.get("nameQuery")??""),[d,i]=j.useState(!1),{open:x,onToggle:w}=D({defaultOpen:!1}),{open:F,onToggle:O}=D({defaultOpen:!1}),{open:U,onToggle:_}=D({defaultOpen:!1}),{open:B,onToggle:H}=D({defaultOpen:!1}),{open:N,onToggle:W}=D({defaultOpen:!1}),{open:ee,onToggle:te}=D({defaultOpen:!1}),{open:ne,onToggle:se}=D({defaultOpen:!1}),$={morning:{start:"04:00",end:"10:59",hours:7},midday:{start:"11:00",end:"12:59",hours:2},afternoon:{start:"13:00",end:"16:59",hours:4},evening:{start:"17:00",end:"20:59",hours:4},night:{start:"21:00",end:"03:59",hours:7}},T=E.local().hour,M=T>=4&&T<11?"morning":T>=11&&T<13?"midday":T>=13&&T<17?"afternoon":T>=17&&T<21?"evening":"night",R=E.local().toFormat("cccc").toLowerCase(),[o,y]=j.useState(R),[a,f]=j.useState(M);j.useEffect(()=>{const u=setTimeout(()=>{(b=>{n(S=>{const c=new URLSearchParams(S);return b.length>2?c.set("nameQuery",b):b.length===0&&c.delete("nameQuery"),c})})(s)},300);return i(s.length>0&&s.length<3),()=>clearTimeout(u)},[s,n]);const p={types:t.getAll("type").length,formats:t.getAll("formats").length,features:t.getAll("features").length,communities:t.getAll("communities").length,languages:t.getAll("languages").length},P=Object.values(p).reduce((u,h)=>u+h,0)+(s?1:0)+(o!==R?1:0)+(a!==M?1:0),z=P>0,I=u=>{const h=E.local();switch(u){case"now":n(S=>{const c=new URLSearchParams(S);return c.set("start",h.toUTC().toISO()),c.set("hours","2"),c}),f(M),y(R);break;case"today":const b=h.startOf("day").plus({hours:h.hour});n(S=>{const c=new URLSearchParams(S);return c.set("start",b.toUTC().toISO()),c.set("hours",(24-h.hour).toString()),c}),y(R),f(M);break;case"thisWeek":n(S=>{const c=new URLSearchParams(S);return c.set("start",h.toUTC().toISO()),c.set("hours","168"),c}),y(R),f(M);break}},V=()=>{g(""),y(R),f(M),n(new URLSearchParams)},v=u=>h=>{n(b=>{const S=ye(t.getAll(u),h);return b.delete(u),S.forEach(c=>{b.append(u,c)}),b})},k=u=>h=>{n(b=>{const c=t.getAll(u).includes(h);return b.delete(u),c||b.append(u,h),b})},A=(u,h)=>{y(u),f(h);const S={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:7}[u.toLowerCase()],c=E.local();let Z=0,oe=0;if(h in $){const{start:q}=$[h];Z=parseInt(q.split(":")[0],10),oe=parseInt(q.split(":")[1],10)}let J=c.set({weekday:S,hour:Z,minute:oe,second:0,millisecond:0});if(c.weekday===S&&(c.hour>Z||c.hour===Z&&c.minute>=oe)?J=J.plus({weeks:1}):c.weekday>S&&(J=J.plus({weeks:1})),h in $){const{hours:q}=$[h],ie=J.toUTC().toISO();n(re=>(ie&&re.set("start",ie),re.set("hours",q.toString()),re))}};return e.jsx(m,{children:e.jsxs(Y,{gap:3,align:"stretch",children:[e.jsxs(m,{children:[e.jsx(Se,{value:s,onChange:g,isInvalid:d}),d&&e.jsx(C,{fontSize:"xs",color:"red.500",mt:1,children:"Enter at least 3 characters."})]}),e.jsxs(Q,{align:"center",justify:"space-between",gap:3,children:[e.jsx(X,{onClick:w,variant:"outline",size:"sm",borderRadius:"md",children:e.jsxs(Q,{align:"center",gap:2,children:[e.jsx(Re,{}),e.jsx(C,{children:"Filters"}),z&&e.jsx(K,{colorScheme:"blue",variant:"solid",borderRadius:"full",children:P}),x?e.jsx(je,{}):e.jsx(fe,{})]})}),e.jsxs(C,{fontSize:"sm",color:"gray.600",_dark:{color:"gray.400"},children:[l," of ",r," meetings"]})]}),e.jsx(m,{overflowX:"auto",pb:1,children:e.jsxs(ze,{gap:2,minW:"fit-content",children:[e.jsx(ae,{label:"Now",onClick:()=>I("now")}),e.jsx(ae,{label:"Today",onClick:()=>I("today")}),e.jsx(ae,{label:"This Week",onClick:()=>I("thisWeek")}),z&&e.jsx(X,{size:"sm",variant:"ghost",colorScheme:"red",onClick:V,borderRadius:"full",px:4,h:8,fontSize:"sm",flexShrink:0,children:e.jsxs(Q,{align:"center",gap:1,children:[e.jsx(Ee,{}),e.jsx(C,{children:"Clear All"})]})})]})}),z&&e.jsxs(Q,{wrap:"wrap",gap:1,children:[s&&e.jsxs(K,{variant:"solid",colorScheme:"blue",borderRadius:"full",fontSize:"xs",children:['Search: "',s.slice(0,20),s.length>20?"...":"",'"']}),o!==R&&e.jsx(K,{variant:"solid",colorScheme:"blue",borderRadius:"full",fontSize:"xs",children:o.charAt(0).toUpperCase()+o.slice(1)}),a!==M&&e.jsx(K,{variant:"solid",colorScheme:"blue",borderRadius:"full",fontSize:"xs",children:a.charAt(0).toUpperCase()+a.slice(1)})]}),x&&e.jsxs(Y,{gap:3,align:"stretch",children:[e.jsx(G,{title:"Day & Time",isOpen:F,onToggle:O,badge:(o!==R?1:0)+(a!==M?1:0),children:e.jsxs(Y,{gap:3,align:"stretch",children:[e.jsxs(m,{children:[e.jsx(C,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Day:"}),e.jsxs(m,{as:"select",value:o,onChange:u=>A(u.target.value,a),w:"full",p:2,border:"1px solid",borderColor:"gray.300",borderRadius:"md",bg:"white",fontSize:"sm",_dark:{bg:"gray.800",borderColor:"gray.600",color:"white"},children:[e.jsx("option",{value:"monday",children:"Monday"}),e.jsx("option",{value:"tuesday",children:"Tuesday"}),e.jsx("option",{value:"wednesday",children:"Wednesday"}),e.jsx("option",{value:"thursday",children:"Thursday"}),e.jsx("option",{value:"friday",children:"Friday"}),e.jsx("option",{value:"saturday",children:"Saturday"}),e.jsx("option",{value:"sunday",children:"Sunday"})]})]}),e.jsxs(m,{children:[e.jsx(C,{fontSize:"sm",fontWeight:"medium",mb:2,children:"Time:"}),e.jsxs(m,{as:"select",value:a,onChange:u=>A(o,u.target.value),w:"full",p:2,border:"1px solid",borderColor:"gray.300",borderRadius:"md",bg:"white",fontSize:"sm",_dark:{bg:"gray.800",borderColor:"gray.600",color:"white"},children:[e.jsx("option",{value:"morning",children:"Morning (4-11 AM)"}),e.jsx("option",{value:"midday",children:"Midday (11 AM-1 PM)"}),e.jsx("option",{value:"afternoon",children:"Afternoon (1-5 PM)"}),e.jsx("option",{value:"evening",children:"Evening (5-9 PM)"}),e.jsx("option",{value:"night",children:"Night (9 PM-4 AM)"})]})]})]})}),e.jsx(G,{title:"Meeting Types",isOpen:U,onToggle:_,badge:p.types,children:e.jsx(L,{displayName:"",options:ge,selected:t.getAll("type"),onToggle:k("type")})}),e.jsx(G,{title:"Formats",isOpen:B,onToggle:H,badge:p.formats,children:e.jsx(L,{displayName:"",options:he,selected:t.getAll("formats"),onToggle:v("formats")})}),e.jsx(G,{title:"Features",isOpen:N,onToggle:W,badge:p.features,children:e.jsx(L,{displayName:"",options:pe,selected:t.getAll("features"),onToggle:v("features")})}),e.jsx(G,{title:"Communities",isOpen:ee,onToggle:te,badge:p.communities,children:e.jsx(L,{displayName:"",options:me,selected:t.getAll("communities"),onToggle:v("communities")})}),e.jsx(G,{title:"Languages",isOpen:ne,onToggle:se,badge:p.languages,children:e.jsx(L,{displayName:"",options:xe,selected:t.getAll("languages"),onToggle:v("languages")})})]})]})})};function He({meetings:t,totalMeetings:n}){return e.jsxs(e.Fragment,{children:[e.jsx(m,{minH:"calc(100vh - 200px)",minW:{base:"100%",md:"600px"},flex:"1",children:e.jsxs(Y,{gap:4,align:"stretch",children:[e.jsxs(le,{size:"lg",children:["Meetings",e.jsxs(C,{as:"span",fontSize:"md",color:"gray.500",ml:2,children:["(",n," total results; ",t.length," shown.)"]})]}),e.jsxs(Y,{gap:6,align:"stretch",children:[t.map(r=>e.jsx(Le,{meeting:r,variant:"list",showActions:!0,showCategories:!0,showNotes:!1,forceResponsive:!0},r.slug)),t.length===0&&e.jsx(C,{color:"gray.500",textAlign:"center",py:8,children:"No meetings found matching your criteria"})]})]})}),e.jsx(ue,{})]})}function $e(t){return[...t.entries()].length?`?${t.toString()}`:`?${new URLSearchParams({start:E.now().toUTC().toISO(),hours:"1"}).toString()}`}async function Ke({request:t}){const{searchParams:n}=new URL(t.url),r=$e(n);return{meetings:await Ne(r)}}const Ze=Te(function({loaderData:n}){const[r,l]=ve(),{meetings:s}=n,g=s.length,[d,i]=j.useState(0),x=25,w=de({base:!0,md:!1}),F=de({base:!1,md:!0}),O=N=>{l(W=>(W.set("nameQuery",N),W))},U=()=>{(d+1)*x<s.length&&i(N=>N+1)},_=()=>{d>0&&i(N=>N-1)},B=s.slice(d*x,(d+1)*x),H=()=>e.jsxs("div",{style:{display:"flex",justifyContent:"center",marginTop:"16px",marginBottom:"16px"},children:[e.jsx("button",{onClick:_,disabled:d===0,style:{marginRight:"8px",padding:"8px 16px",backgroundColor:"#3182ce",color:"white",border:"none",borderRadius:"4px",cursor:d===0?"not-allowed":"pointer"},children:"Previous"}),e.jsx("button",{onClick:U,disabled:(d+1)*x>=s.length,style:{padding:"8px 16px",backgroundColor:"#3182ce",color:"white",border:"none",borderRadius:"4px",cursor:(d+1)*x>=s.length?"not-allowed":"pointer"},children:"Next"})]});return e.jsxs(e.Fragment,{children:[e.jsxs(We,{sidebar:F?e.jsx(_e,{filterParams:r,sendFilterSelectionsToParent:l,sendQueryToParent:O}):void 0,children:[w&&e.jsx(m,{mb:6,children:e.jsx(Be,{filterParams:r,sendFilterSelectionsToParent:l,totalMeetings:g,shownMeetings:B.length})}),s.length>0?e.jsxs(e.Fragment,{children:[e.jsx(H,{}),e.jsx(He,{meetings:B,totalMeetings:g}),e.jsx(H,{})]}):e.jsx(C,{textAlign:"center",py:8,color:"gray.500",children:"No meetings found matching your criteria."})]}),e.jsx(ue,{})]})});export{Ke as clientLoader,Ze as default};
